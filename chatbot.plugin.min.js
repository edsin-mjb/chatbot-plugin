window.Chatbot=function(o,e){const c=Object.assign({},{url:"ws://localhost:9080/ws",headerText:"Chat us",inputPlaceholder:"Type your message...",topic:"",welcomeMessage:"Hello! How can I assist you today?"},e);var s=new WebSocket(c.url);let a="",d="",i,l,r;function u(e,t,n){n?(a="",d="",i=l=r=null):a.length?a&&(r.textContent+=e,a+=e,i.scrollTop=i.scrollHeight):(i=o.querySelector(".chat-window"),(l=document.createElement("div")).classList.add("message",t),(r=document.createElement("pre")).textContent=e,l.appendChild(r),i.appendChild(l),a+=e,i.scrollTop=i.scrollHeight)}function t(){var e=o.querySelector(".input-container input");if(e&&e.value?.trim()?.length){u(e.value,"sent",0),u("","sent",1);const d=e.value?.toLowerCase().split(" ");if(["hi","hello","hey","greetings"].some(e=>d.includes(e)))u("Hello! How can I assist you today?","received",0),u("","received",1);else{var t=o.querySelector(".chat-window"),n=document.createElement("div");n.id="typing-anime",n.classList.add("typing-animation");for(let e=0;e<3;e++){var a=document.createElement("span");n.appendChild(a)}t.appendChild(n),t.scrollTop=t.scrollHeight,s.send(JSON.stringify({search:e.value,title:c.topic}))}e.value=""}}function n(){var e=document.querySelector(".chatbot-window"),t=document.querySelector(".chat-rounded");e.classList.remove("hide"),e.classList.add("show"),t.classList.remove("show"),t.classList.add("hide")}function h(){var e=document.querySelector(".chatbot-window"),t=document.querySelector(".chat-rounded");e.classList.remove("show"),e.classList.add("hide"),t.classList.remove("hide"),t.classList.add("show")}s.addEventListener("open",function(e){console.log("WebSocket connection established.")}),s.addEventListener("message",function({data:e}){(t=document.getElementById("typing-anime"))&&t.remove();var t=JSON.parse(e);u(t?.message?.content,"received",t.isEnd)}),s.addEventListener("close",function(e){console.log("WebSocket connection closed."),s=new WebSocket(c.url)}),s.addEventListener("error",function(e){console.error("WebSocket error:",e)});var e=document.createElement("link"),m=(e.rel="stylesheet",e.href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css",document.head.appendChild(e),(e=document.createElement("div")).classList.add("chatbot-window"),o.appendChild(e),document.createElement("div")),p=(m.classList.add("chat-header"),document.createElement("label")),v=(p.textContent=c.headerText,document.createElement("button"));m.appendChild(p),v.innerHTML='<i class="fa fa-times" aria-hidden="true"></i>',v.addEventListener("click",h),m.appendChild(v),e.appendChild(m),(p=document.createElement("div")).classList.add("chat-window"),e.appendChild(p),(v=document.createElement("div")).classList.add("input-container"),e.appendChild(v),(m=document.createElement("input")).setAttribute("type","text"),m.setAttribute("placeholder",c.inputPlaceholder),v.appendChild(m),(p=document.createElement("button")).textContent="Send",p.addEventListener("click",t),v.appendChild(p),(e=document.createElement("button")).classList.add("chat-rounded"),e.classList.add("hide"),e.innerHTML='<i class="fa fa-commenting-o chat-icon" aria-hidden="true"></i>',e.addEventListener("click",n),o.appendChild(e),u(c.welcomeMessage,"received",0),u("","sent",1)};